# SBOMシステム要件定義書

## 1. システム概要

### 1.1 システム名
SBOM（Software Bill of Materials）管理システム

### 1.2 システム目的
機械管理台帳におけるWeBOM情報から個体情報として部品構成を管理し、メンテナンス時の部品変更履歴追跡、セット品の階層管理を効率的に行うためのシステム

### 1.3 対象ユーザー
- 機械メンテナンス担当者
- 部品管理担当者
- 機械管理台帳管理者

## 2. 画面構成・機能要件

### 2.1 画面No.1: 機械管理台帳デフォルト画面（既存）

**概要**
既存の機械管理台帳初期画面

**構成**
- 既存項目（抽出機能、機械一覧）

**操作**
- 機械一覧レコードダブルクリック → 画面No.2へ遷移

---

### 2.2 画面No.2: 個体詳細画面（既存拡張）

**概要**
機械個体の詳細情報を表示する画面

**構成**
- ヘッダー情報
- 既存項目
- 必要ボタン

**操作ボタン**
1. **部品一覧画面を開く** → 画面No.3へ遷移
2. **閉じる** → 画面No.1へ戻る

---

### 2.3 画面No.3: 個体部品一覧画面（新規）

**概要**
個体の部品構成を一覧表示し、部品管理の各種操作を行う中心画面

**構成**
- ヘッダー情報
- 部品一覧
- オプショングループ
- 必要ボタン

**オプショングループ（表示モード）**
1. **通常**: 直接機械に付いている単位の部品構成を表示
2. **階層表示**: 子部品のあるセット品について、その下の階層を表示
3. **部品展開**: セット品を全て分解して最終的な子部品のみ表示（数は合算する）

**操作ボタン**
1. **部品情報取得画面を開く** → 画面No.4へ遷移
2. **部品変更画面を開く** → 画面No.6へ遷移
3. **セット品登録編集画面を開く** → 画面No.7へ遷移
4. **閉じる** → 前画面へ戻る

---

### 2.4 画面No.4: 部品情報取得画面（新規）

**概要**
型式と日付を選択し、その時点のWeBOM情報からユニットをばらさない形で部品構成を取得し、個体情報として登録する画面

**構成**
- 型式テキストボックス
- 日付テキストボックス
- サブフォーム（取得結果表示）
- 必要ボタン

**業務ロジック**
- ユニットはセット品に振り替え
- SBOM上で任意に親子関係を編集可能

**操作ボタン**
1. **部品情報取得** → 部品情報取得実行 or 画面No.5へ（型式にオプションがある場合）
2. **取得結果登録** → 取得した部品情報を個体情報として登録
3. **閉じる** → 前画面へ戻る

**サブフォーム**
- 部品情報取得ボタンをクリック時に取得される部品情報を表示

**入力補助機能**
- 型式やオプション情報は個体情報として登録済み
- これらの情報をNo.4やNo.5に自動反映し、入力を省略可能

---

### 2.5 画面No.5: オプション選択画面（新規）

**概要**
選択した型式にオプションがある場合に、適用するオプションを選択する画面

**構成**
- 対象型式のオプション一覧（自動入力）

**機能詳細**
- 対象型式のオプション一覧にチェックボックスを表示
- ユーザーがオプションを選択可能

**操作ボタン**
1. **オプション選択確定ボタン** → 選択内容を確定
2. **閉じる** → 前画面へ戻る

**表示条件**
- 選択した型式にオプションがある場合のみ表示

**入力補助機能**
- 個体情報として登録されている型式やオプション情報を自動反映

---

### 2.6 画面No.6: 部品変更画面（新規）

**概要**
機械メンテナンス時の部品変更履歴を登録する画面

**構成**
- 変更前品番テキストボックス
- 変更後品番テキストボックス
- 変更後個数テキストボックス
- その他必要情報（変更日、互換、背景、備考など）
- 必要ボタン

**操作ボタン**
1. **部品一覧に反映ボタン** → 変更内容を部品一覧に反映
2. **閉じる** → 前画面へ戻る

**業務用途**
- 機械のメンテナンス時に登録

---

### 2.7 画面No.7: セット登録・編集画面（新規）

**概要**
セット品の登録、解除、変更を行う画面

**構成**
- セット品番テキストボックス
- セット子部品一覧
- 必要ボタン

**操作ボタン**
1. **セット解除** → セット品を解除
2. **子部品追加** → セット品に子部品を追加
3. **子部品削除** → セット品から子部品を削除
4. **確定** → セット品の変更を確定
5. **閉じる** → 前画面へ戻る

**業務ロジック**
- T_個体部品子部品サブテーブルに格納されるデータを作成
- セット解除時：ぶら下がっている部品が一つ上の階層のセット品または個体に付く
- セット子部品一覧には、この個体に登録されている部品のみ登録可能（セット品含む）

**課題事項**
- セット品の下にセット品が存在するケースについて、必要機能の詳細検討が必要

## 3. 画面遷移図

```
画面No.1: 機械管理台帳デフォルト画面（既存）
    ↓（機械一覧レコードダブルクリック）
画面No.2: 個体詳細画面（既存拡張）
    ↓（部品一覧画面を開く）
画面No.3: 個体部品一覧画面（新規）
    ├─ 画面No.4: 部品情報取得画面（新規）
    │       ↓（型式にオプションがある場合）
    │   画面No.5: オプション選択画面（新規）
    ├─ 画面No.6: 部品変更画面（新規）
    └─ 画面No.7: セット登録・編集画面（新規）
```

## 4. 技術要件

### 4.1 データ連携
- WeBOM情報との連携
- 個体情報としての部品構成管理
- T_個体部品子部品サブテーブルでのセット品管理

### 4.2 業務ロジック
- ユニットからセット品への振り替え機能
- 階層表示での親子関係管理
- 部品展開時の数量合算機能

### 4.3 入力補助機能
- 個体情報に基づく型式・オプション情報の自動入力
- メンテナンス履歴に基づく変更パターンの推奨

## 5. データ設計

### 5.1 主要テーブル
- **T_個体部品子部品サブ**: セット品の子部品情報を格納
- **個体情報テーブル**: 型式、オプション情報を格納
- **部品変更履歴テーブル**: メンテナンス時の変更履歴を格納

### 5.2 外部システム連携
- **WeBOM情報**: 部品構成の基準情報取得
- **部品マスタ**: 部品詳細情報の取得

## 6. 非機能要件

### 6.1 性能要件
- 部品情報取得: WeBOMからの取得を10秒以内
- 階層表示: 5階層まで対応、表示時間3秒以内
- 部品展開: 1,000部品まで対応、展開時間5秒以内

### 6.2 ユーザビリティ要件
- 直感的な操作が可能なUI設計
- 入力補助機能による作業効率向上
- エラーメッセージの明確な表示

### 6.3 保守性要件
- セット品階層の複雑化に対応可能な拡張性
- 部品変更パターンの学習機能への対応

## 7. 課題・検討事項

### 7.1 要検討項目
1. **セット品の多階層管理**
   - セット品の下にセット品が存在するケースの処理方法
   - セット解除時の子部品の移動ルール

2. **入力補助機能の詳細**
   - 個体情報の自動反映範囲
   - 推奨パターンの学習アルゴリズム

3. **WeBOM連携の詳細**
   - 取得タイミングとデータ更新頻度
   - 差分管理の方法

### 7.2 今後のヒアリング項目
- セット品階層管理の業務ルール詳細
- 部品変更時の承認フロー
- データ移行方法と運用開始時期

## 8. 更新履歴

| 日付 | バージョン | 更新者 | 更新内容 |
|------|------------|--------|----------|
| 2025-06-22 | 2.0 | システム担当 | Excel仕様書に基づき全面改訂 |