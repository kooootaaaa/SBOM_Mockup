# SBOMシステム要件定義書

## 1. システム概要

### 1.1 システム名
SBOM（Software Bill of Materials）管理システム

### 1.2 システム目的
機械管理台帳におけるWeBOM情報から個体情報として部品構成を管理し、メンテナンス時の部品変更履歴追跡、セット品の階層管理を効率的に行うためのシステム

### 1.3 対象ユーザー
- 機械メンテナンス担当者
- 部品管理担当者
- 機械管理台帳管理者

## 2. 画面構成・機能要件

### 2.1 画面No.1: 機械管理台帳デフォルト画面（既存）

**概要**
既存の機械管理台帳初期画面。機械の製造番号や型式、状態などの情報を一覧で表示し、条件抽出や詳細確認、管理を行う。

**主な機能**
- 機械台帳データの一覧表示
- 抽出条件によるデータフィルタリング
- 抽出実行・解除
- 各種項目によるソート
- 詳細画面への遷移

**入力項目・操作項目**
| 項目名             | 種別     | 内容・備考                         |
|--------------------|----------|------------------------------------|
| メニュー           | ドロップダウン | 他画面への遷移用                  |
| 実行/閉じる        | ボタン   | 抽出実行、画面クローズ             |
| 抽出条件           | チェックボックス/ドロップダウン/テキスト | 仕掛り、未装備、出荷前、出荷後、CR戻り機、保留、デモ機、完成、シリーズ、型式、機種名、販売店、ユーザー、製造番号、ロット番号、メーカーオプション、管理区分、状態、ケースNo等 |
| 抽出実行           | ボタン   | 条件に基づき一覧を再表示           |
| 解除               | ボタン   | 抽出条件のリセット                 |

**一覧表示項目**
| 項目名             | 内容例           | 備考           |
|--------------------|------------------|----------------|
| 製造番号           | 1510006          |                |
| 完成日             | 15-09-17         |                |
| 型式               | WTD-T16I         |                |
| 機種名             | トルネードT16αR  |                |
| 現在地             | 本社              |                |
| 機械状態           | 高荷重機          |                |
| 河北製造番号       |                  |                |
| 過去製造番号       | 22028829          |                |
| ロット番号         |                  |                |
| パレットNo.        |                  |                |
| 預けNo.            |                  |                |
| 仕様変更履歴       |                  |                |
| 管理区分           | 新品/中古         |                |
| 状態               | F-6/REなど        |                |
| メーカーオプション | クレーム返却後等  |                |
| 客先仕様           |                  |                |
| 業務連絡等         |                  |                |
| 製造備考           |                  |                |

**操作フロー**
1. 必要に応じて抽出条件を設定
2. 「抽出実行」ボタン押下で一覧を更新
3. 「解除」ボタンで条件リセット
4. 一覧から詳細画面へ遷移

**備考・注意事項**
- 一覧の表示件数やページング仕様は別途定義
- 抽出条件の組み合わせや必須項目は要件に応じて調整
- 権限による表示・操作制御が必要な場合は別途記載

### 2.2 画面No.2: 機械詳細画面

**概要**
選択した機械の個体情報・基本情報・履歴・仕様等を詳細に表示・編集する画面。

**主な機能**
- 個体情報（製造番号、型式、機種名、案件番号等）の表示・編集
- 基本情報（製造種別、現在地、機械状態、管理区分、完成日等）の表示・編集
- メーカーオプション、客先仕様、仕様変更履歴、組立指示書備考、改造内容等の表示・編集
- タブ切替による「製造情報」「出荷情報」「預け情報」「メンテナンス情報」「クレーム情報」の表示
- 「登録」「キャンセル」ボタンによるデータ保存・画面遷移

**入力・表示項目**
＜個体情報＞
| 項目名             | 種別         | 備考例                      |
|--------------------|--------------|-----------------------------|
| 生産ライン         | ドロップダウン |                             |
| 型式               | ドロップダウン |                             |
| 枝番               | ドロップダウン |                             |
| 機種名             | テキスト      |                             |
| ロットNo.          | テキスト      |                             |
| ロット通番         | テキスト      |                             |
| 号機番号           | テキスト      |                             |
| 案件番号           | テキスト      |                             |
| 中古案件番号       | テキスト      |                             |
| 取付タグ番号       | テキスト      |                             |
| 注文書識別番号     | テキスト      |                             |
| 預けNo.            | テキスト      |                             |
| 製造番号           | テキスト      |                             |
| 河北製造番号       | テキスト      |                             |
| 過去製造番号       | テキスト      |                             |
| 社内メモ           | テキストエリア |                             |
| マスタ外登録       | チェックボックス |                           |

＜基本情報・その他＞
| 項目名             | 種別         | 備考例                      |
|--------------------|--------------|-----------------------------|
| 製造種別           | ドロップダウン | 例：自社、外注              |
| 現在地             | ドロップダウン | 例：本社倉庫、大高倉庫      |
| 機械状態           | ドロップダウン | 例：完成、未完成            |
| 管理区分           | ドロップダウン | 例：新品、中古              |
| 完成予定日         | 日付         |                             |
| 仕掛品完成日       | 日付         |                             |
| 完成日             | 日付         |                             |
| CR登録日           | 日付         |                             |
| 難                 | チェックボックス |                           |
| 非在庫品           | チェックボックス |                           |
| メーカーオプション | テキストエリア |                             |
| 客先仕様           | テキストエリア |                             |
| 仕様変更履歴       | テキストエリア | 改造日・内容                |
| 組立指示書備考     | テキストエリア |                             |
| 改造内容           | テキストエリア |                             |

＜タブ情報＞
- 製造情報タブ
  - 基本情報（製造種別、現在地、機械状態、管理区分、完成予定日、仕掛品完成日、完成日、CR登録日、難、非在庫品）
  - メーカーオプション
  - 客先仕様
  - 仕様変更履歴、改造日
  - 組立指示書備考
  - 改造内容
- 出荷情報タブ（今後拡張）
- 預け情報タブ（今後拡張）
- メンテナンス情報タブ（今後拡張）
- クレーム情報タブ（今後拡張）

**操作フロー**
1. 機械台帳一覧から対象機械を選択し、本画面を表示
2. 必要な情報を入力・編集
3. 必要に応じて「部品一覧画面を開く」ボタンで画面No.3へ遷移
4. 「登録」ボタンで保存、「キャンセル」ボタンで変更を破棄

**備考・注意事項**
- 必須項目や入力制御は別途定義
- 編集不可項目や自動入力項目は要件に応じて設定
- タブごとの詳細項目は別途定義
- 「部品一覧画面を開く」「登録」「キャンセル」の各ボタンは同じ幅で横並びに配置
- 「部品一覧画面を開く」ボタンをクリックすると、現在表示中の機械の部品一覧画面（画面No.3）に遷移

### 2.3 画面No.3: 個体部品一覧画面（新規）

**概要**
個体の部品構成を一覧表示し、部品管理の各種操作を行う中心画面

**構成**
- ヘッダー情報
- 部品一覧
- オプショングループ
- 必要ボタン

**ヘッダー情報項目**
| 項目名     | 表示例         | 説明                           |
|------------|----------------|--------------------------------|
| 製造番号   | 1510006        | 機械の個体識別番号             |
| 型式       | WTD-T16I       | 機械の型式                     |
| 機種名     | トルネードT16αR | 機械の名称                     |
| 完成日     | 2024-09-17     | 機械の完成日                   |
| 現在地     | 本社倉庫       | 機械の現在の保管場所           |
| 機械状態   | 完成           | 機械の現在の状態               |
| 管理区分   | 新品           | 新品/中古の区分                |
| 案件番号   | A-2024-0892    | 関連する案件の番号             |
| ロット番号 | L2024-09       | 製造ロットの番号               |

**オプショングループ（表示モード）**
1. **通常**: 直接機械に付いている単位の部品構成を表示
2. **階層表示**: 子部品のあるセット品について、その下の階層を表示
3. **部品展開**: セット品を全て分解して最終的な子部品のみ表示（数は合算する）

**操作ボタン**
1. **部品表示** → 選択中の表示モードに従って部品一覧を表示/非表示
2. **部品情報取得画面を開く** → 画面No.4へ遷移
3. **部品変更画面を開く** → 画面No.6へ遷移
4. **セット品登録編集画面を開く** → 画面No.7へ遷移
5. **閉じる** → 前画面へ戻る

**表示制御**
- 画面初期表示時は部品一覧を非表示とする
- 「部品表示」ボタンは、通常・階層表示・部品展開の右に配置
- 「部品表示」ボタンをクリックすると部品一覧の表示/非表示を切り替える
- 表示モード（通常・階層表示・部品展開）により表示内容を切り替える（詳細な実装は後日）

---

### 2.4 画面No.4: 部品情報取得画面（新規）

**概要**
型式と日付を選択し、その時点のWeBOM情報からユニットをばらさない形で部品構成を取得し、個体情報として登録する画面

**構成**
- 型式テキストボックス
- 日付テキストボックス
- サブフォーム（取得結果表示）
- 必要ボタン

**業務ロジック**
- ユニットはセット品に振り替え
- SBOM上で任意に親子関係を編集可能

**操作ボタン**
1. **部品情報取得** → 部品情報取得実行 or 画面No.5へ（型式にオプションがある場合）
2. **取得結果登録** → 取得した部品情報を個体情報として登録
3. **閉じる** → 前画面へ戻る

**サブフォーム**
- 部品情報取得ボタンをクリック時に取得される部品情報を表示

**入力補助機能**
- 型式やオプション情報は個体情報として登録済み
- これらの情報をNo.4やNo.5に自動反映し、入力を省略可能

---

### 2.5 画面No.5: オプション選択画面（新規）

**概要**
選択した型式にオプションがある場合に、適用するオプションを選択する画面

**構成**
- 対象型式のオプション一覧（自動入力）

**機能詳細**
- 対象型式のオプション一覧にチェックボックスを表示
- ユーザーがオプションを選択可能

**操作ボタン**
1. **オプション選択確定ボタン** → 選択内容を確定
2. **閉じる** → 前画面へ戻る

**表示条件**
- 選択した型式にオプションがある場合のみ表示

**入力補助機能**
- 個体情報として登録されている型式やオプション情報を自動反映

---

### 2.6 画面No.6: 部品変更画面（新規）

**概要**
機械メンテナンス時の部品変更履歴を登録する画面

**構成**
- 変更前品番テキストボックス
- 変更後品番テキストボックス
- 変更後個数テキストボックス
- その他必要情報（変更日、互換、背景、備考など）
- 必要ボタン

**操作ボタン**
1. **部品一覧に反映ボタン** → 変更内容を部品一覧に反映
2. **閉じる** → 前画面へ戻る

**業務用途**
- 機械のメンテナンス時に登録

---

### 2.7 画面No.7: セット登録・編集画面（新規）

**概要**
セット品の登録、解除、変更を行う画面

**構成**
- セット品番テキストボックス
- セット子部品一覧
- 必要ボタン

**操作ボタン**
1. **セット解除** → セット品を解除
2. **子部品追加** → セット品に子部品を追加
3. **子部品削除** → セット品から子部品を削除
4. **確定** → セット品の変更を確定
5. **閉じる** → 前画面へ戻る

**業務ロジック**
- T_個体部品子部品サブテーブルに格納されるデータを作成
- セット解除時：ぶら下がっている部品が一つ上の階層のセット品または個体に付く
- セット子部品一覧には、この個体に登録されている部品のみ登録可能（セット品含む）

**課題事項**
- セット品の下にセット品が存在するケースについて、必要機能の詳細検討が必要

## 3. 画面遷移図

```
画面No.1: 機械管理台帳デフォルト画面（既存）
    ↓（機械一覧レコードダブルクリック）
画面No.2: 機械詳細画面
    ↓（部品一覧画面を開く）
画面No.3: 個体部品一覧画面（新規）
    ├─ 画面No.4: 部品情報取得画面（新規）
    │       ↓（型式にオプションがある場合）
    │   画面No.5: オプション選択画面（新規）
    ├─ 画面No.6: 部品変更画面（新規）
    └─ 画面No.7: セット登録・編集画面（新規）
```

## 4. 技術要件

### 4.1 データ連携
- WeBOM情報との連携
- 個体情報としての部品構成管理
- T_個体部品子部品サブテーブルでのセット品管理

### 4.2 業務ロジック
- ユニットからセット品への振り替え機能
- 階層表示での親子関係管理
- 部品展開時の数量合算機能

### 4.3 入力補助機能
- 個体情報に基づく型式・オプション情報の自動入力
- メンテナンス履歴に基づく変更パターンの推奨

## 5. データ設計

### 5.1 主要テーブル
- **T_個体部品子部品サブ**: セット品の子部品情報を格納
- **個体情報テーブル**: 型式、オプション情報を格納
- **部品変更履歴テーブル**: メンテナンス時の変更履歴を格納

### 5.2 外部システム連携
- **WeBOM情報**: 部品構成の基準情報取得
- **部品マスタ**: 部品詳細情報の取得

## 6. 非機能要件

### 6.1 性能要件
- 部品情報取得: WeBOMからの取得を10秒以内
- 階層表示: 5階層まで対応、表示時間3秒以内
- 部品展開: 1,000部品まで対応、展開時間5秒以内

### 6.2 ユーザビリティ要件
- 直感的な操作が可能なUI設計
- 入力補助機能による作業効率向上
- エラーメッセージの明確な表示

### 6.3 保守性要件
- セット品階層の複雑化に対応可能な拡張性
- 部品変更パターンの学習機能への対応

## 7. 課題・検討事項

### 7.1 要検討項目
1. **セット品の多階層管理**
   - セット品の下にセット品が存在するケースの処理方法
   - セット解除時の子部品の移動ルール

2. **入力補助機能の詳細**
   - 個体情報の自動反映範囲
   - 推奨パターンの学習アルゴリズム

3. **WeBOM連携の詳細**
   - 取得タイミングとデータ更新頻度
   - 差分管理の方法

### 7.2 今後のヒアリング項目
- セット品階層管理の業務ルール詳細
- 部品変更時の承認フロー
- データ移行方法と運用開始時期

## 8. 更新履歴

| 日付 | バージョン | 更新者 | 更新内容 |
|------|------------|--------|----------|
| 2025-06-22 | 2.0 | システム担当 | Excel仕様書に基づき全面改訂 |