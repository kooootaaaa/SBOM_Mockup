# SBOMシステム

製造業向けの部品表（BOM: Bill of Materials）管理システムです。機械の製造番号ごとに部品構成を管理し、部品の追跡や変更履歴を記録します。

## プロジェクト構成

```
SBOM/
├── SBOMSystemAPI/          # Web APIプロジェクト（ASP.NET Core）
├── SBOMSystemMockup/       # フロントエンドプロジェクト（Blazor WebAssembly）
└── sbom_requirements.md    # 要件定義書
```

## 主な機能

### 実装完了機能 ✅
- **機械管理台帳**: 製造番号による機械の個体管理（一覧・詳細・編集）
- **機械詳細管理**: タブ形式での詳細情報管理（製造情報・出荷情報等）
- **部品情報取得**: WeBOMからの部品情報取得とリアルタイム機種検索
- **オプション選択**: 機種別オプションユニットの選択機能
- **ツリー表示**: ユニット・オプションの子部品階層表示
- **ページネーション**: 大量データ対応の効率的な表示

### 実装予定機能 🚧
- **部品変更履歴**: 部品の変更理由と履歴の記録
- **セット品管理**: 複数部品をまとめたセット品の登録・編集
- **個体部品管理**: 機械個体ごとの部品構成管理

## 技術スタック

- **フロントエンド**: Blazor WebAssembly (.NET 9)
- **バックエンド**: ASP.NET Core Web API (.NET 9)
- **データベース**: SQL Server (WeBOMSQL@192.168.1.19)
- **CSS フレームワーク**: Bootstrap 5

## 開発環境のセットアップ

### 必要なツール

- .NET 9 SDK
- Visual Studio 2022 または Visual Studio Code
- SQL Server アクセス権限

### 実行方法

1. リポジトリをクローン
```bash
git clone [repository-url]
cd SBOM
```

2. APIプロジェクトの実行
```bash
cd SBOMSystemAPI
dotnet run
# APIサーバーが http://localhost:5196 で起動
```

3. フロントエンドプロジェクトの実行（別ターミナル）
```bash
cd SBOMSystemMockup
dotnet run
# フロントエンドが https://localhost:7001 で起動
```

4. ブラウザで `https://localhost:7001` にアクセス

## 画面構成と実装状況

| 画面No. | 画面名 | 実装状況 | 主な機能 |
|---------|--------|----------|----------|
| 1 | 機械管理台帳デフォルト画面 | ✅ 完了 | 機械一覧・フィルタリング・ページネーション |
| 2 | 機械詳細画面 | ✅ 完了 | 詳細情報表示・編集・タブ切替 |
| 3 | 個体部品一覧画面 | ✅ 基本実装 | 部品一覧・表示モード切替 |
| 4 | 部品情報取得画面 | ✅ 完了 | 機種検索・部品取得・ツリー表示 |
| 5 | オプション選択画面 | ✅ 完了 | オプションユニット選択モーダル（画面No.4内） |
| 6 | 部品変更画面 | ❌ 未実装 | 変更履歴登録・管理 |
| 7 | セット登録・編集画面 | ❌ 未実装 | セット品管理・階層構造 |

## データベース構成

### 実装済みテーブル
- **T_機械管理台帳**: 機械の基本情報
- **T_部品マスタ**: 部品のマスタ情報
- **T_機種マスタ**: 機種情報
- **T_機種部品サブ**: 機種別部品構成
- **T_部品子部品サブ**: ユニット・オプションの子部品情報

### 未実装テーブル
- **T_個体部品**: 機械個体ごとの部品構成
- **T_部品変更履歴**: 部品変更の履歴管理
- **T_セット品**: セット品の定義

## API エンドポイント

### MachineController
- `GET /api/Machine` - 機械一覧取得（フィルタ・ページネーション対応）
- `GET /api/Machine/{id}` - 機械詳細取得
- `GET /api/Machine/by-serial/{serialNumber}` - 製造番号検索
- `PUT /api/Machine/{id}` - 機械情報更新
- `GET /api/Machine/search-model/{modelName}` - 機種検索
- `POST /api/Machine/fetch-parts` - 部品情報取得
- `POST /api/Machine/parts-children` - 子部品情報取得（ツリー表示用）

### PartsController
- `GET /api/Parts` - 部品一覧取得
- `GET /api/Parts/sample` - サンプルデータ取得

## 主要機能の詳細

### ツリー表示機能
- ユニット・オプション部品の階層表示
- 展開/折りたたみによる動的表示制御
- 階層番号による親子関係の明確化
- 遅延読み込みによるパフォーマンス最適化
- 数量の自動計算（親部品数量 × 子部品数量）

### 検索・フィルタリング機能
- リアルタイム機種検索（部分一致対応）
- 複数条件による機械台帳フィルタリング
- ページネーション（15件/ページ）
- エラーハンドリングとフォールバック

## 開発ガイドライン

- **コーディング規約**: C#標準規約に準拠
- **コミットメッセージ**: 日本語で簡潔に記述
- **ブランチ戦略**: main + feature/topic ブランチ
- **要件管理**: sbom_requirements.md で仕様を管理

## 今後の開発予定

1. **高優先度**: 部品変更画面（No.6）の実装
2. **高優先度**: セット登録・編集画面（No.7）の実装
3. **中優先度**: 個体部品一覧画面（No.3）の実データベース連携
4. **低優先度**: セキュリティ強化・テスト・ドキュメント整備

## ドキュメント

- [要件定義書](SBOMSystemMockup/sbom_requirements.md) - 詳細な機能要件と実装状況